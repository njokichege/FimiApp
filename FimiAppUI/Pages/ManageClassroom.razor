@page "/Pages/ManageClassroom"

@inherits ManageClassroomBase

<MudDivider DividerType="DividerType.FullWidth" Class="my-6" />
@if (showSuccessAlert)
{
    <MudAlert Severity="Severity.Success" ContentAlignment="HorizontalAlignment.Center" ShowCloseIcon="true" CloseIconClicked="(() => CloseMe(true))">@ModelSuccess</MudAlert>
}
@if (showFailAlert)
{
    <MudAlert Severity="Severity.Error" ContentAlignment="HorizontalAlignment.Center" ShowCloseIcon="true" CloseIconClicked="(() => CloseMe(true))">@ModelFail</MudAlert>
}
<MudGrid>
    <MudItem xs="3">
        <MudCard Style="margin-top:20px">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Style="@($"margin-top:20px;")" Typo="Typo.h5" Align="Align.Center">Add Class</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudDivider DividerType="DividerType.FullWidth" Class="my-6" />
            <MudCardContent>
                <MudAutocomplete T="FormModel" Label="Form" @bind-Value="SelectedFormOnClassCard" ShowProgressIndicator="true"
                                 SearchFunc="@FormSearchOnClassCard" ToStringFunc="@(e=> e==null?null : $"{e.Form}")" />
                <MudAutocomplete T="StreamModel" Label="Stream" @bind-Value="SelectedStreamOnClassCard" ShowProgressIndicator="true"
                                 SearchFunc="@StreamSearchOnClassCard" ToStringFunc="@(e=> e==null?null : $"{e.Stream}")" />
                <MudAutocomplete T="SessionYearModel" Label="Session Year" @bind-Value="SelectedSessionYearOnClassCard" ShowProgressIndicator="true"
                                 SearchFunc="@SessionYearSearchOnClassCard" ToStringFunc="@(e=> e==null?null : $"{e.SessionString()}")" />
            </MudCardContent>
            <MudCardActions>
                <MudButton Variant="Variant.Filled" FullWidth="true" OnClick="@CreateClass" StartIcon="@Icons.Material.Filled.Save" Style="background-color:#e38d43">Submit</MudButton>
            </MudCardActions>
        </MudCard>
        <MudCard Style="margin-top:20px">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Style="@($"margin-top:20px;")" Typo="Typo.h5" Align="Align.Center">Assign Class Teacher</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudDivider DividerType="DividerType.FullWidth" Class="my-6" />
            <MudCardContent>
                <MudAutocomplete T="FormModel" Label="Form" @bind-Value="SelectedFormOnTeacherCard" ShowProgressIndicator="true"
                                 SearchFunc="@FormSearchOnTeacherCard" ToStringFunc="@(e=> e==null?null : $"{e.Form}")" />
                <MudAutocomplete T="StreamModel" Label="Stream" @bind-Value="SelectedStreamOnTeacherCard" ShowProgressIndicator="true"
                                 SearchFunc="@StreamSearchOnTeacherCard" ToStringFunc="@(e=> e==null?null : $"{e.Stream}")" />
                <MudAutocomplete T="SessionYearModel" Label="Session Year" @bind-Value="SelectedSessionYearOnTeacherCard" ShowProgressIndicator="true"
                                 SearchFunc="@SessionYearSearchOnTeacherCard" ToStringFunc="@(e=> e==null?null : $"{e.SessionString()}")" />
                <MudAutocomplete T="TeacherModel" Label="Teacher" @bind-Value="SelectedTeacherOnTeacherCard" ShowProgressIndicator="true"
                                 SearchFunc="@TeacherSearchOnTeacherCard" ToStringFunc="@(e=> e==null?null : $"{e.ClassTeacherName()}")" />
            </MudCardContent>
            <MudCardActions>
                <MudButton Variant="Variant.Filled" FullWidth="true" OnClick="@AssignClassTeacher" StartIcon="@Icons.Material.Filled.Save" Style="background-color:#e38d43">Submit</MudButton>
            </MudCardActions>
        </MudCard>
        <MudCard Style="margin-top:20px">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Style="@($"margin-top:20px;")" Typo="Typo.h5" Align="Align.Center">Create New School Year</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudDivider DividerType="DividerType.FullWidth" Class="my-6" />
            <MudCardContent>
                <MudDatePicker Label="Start Date" @bind-Date="startDate" />
                <MudDatePicker Label="End Date" @bind-Date="endDate" />
            </MudCardContent>
            <MudCardActions>
                <MudButton Variant="Variant.Filled" OnClick="@CreateNewSchoolYear" FullWidth="true" StartIcon="@Icons.Material.Filled.Save" Style="background-color:#e38d43">Submit</MudButton>
            </MudCardActions>
        </MudCard>
    </MudItem>
    <MudItem xs="8">
        <MudCard Style="margin-top:20px">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Style="@($"margin-top:20px;")" Typo="Typo.h5" Align="Align.Center">School Year : @SessionYearModelTitle</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudDivider DividerType="DividerType.FullWidth" Class="my-6" />
            <MudCardContent>
                <MudAutocomplete T="SessionYearModel" Label="Change School Year" @bind-Value="SelectedSessionYearOnSessionYearCard" ShowProgressIndicator="true"
                                 SearchFunc="@SessionYearSearchOnSessionYearCard" ToStringFunc="@(e=> e==null?null : $"{e.SessionString()}")" />
            </MudCardContent>
            <MudCardActions>
                <MudButton Variant="Variant.Filled" FullWidth="true" StartIcon="@Icons.Material.Filled.Save" Style="background-color:#e38d43" OnClick="@ChangeSchoolYear">Submit</MudButton>
            </MudCardActions>
        </MudCard>
        <MudDataGrid Items="@Classes" Style="margin-top:20px">
            <Columns>
                <PropertyColumn Property="x => x.ClassId" Title="#" />
                <PropertyColumn Property="x => x.FullClass()" Title="#" />
                <PropertyColumn Property="x => x.Teacher.ClassTeacherName()" Title="#" />
            </Columns>
        </MudDataGrid>
    </MudItem>
</MudGrid>
<MudGrid>

</MudGrid>





